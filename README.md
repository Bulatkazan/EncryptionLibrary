# RC4 Stream Cipher Implementation in C

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–∞ **RC4 (Arcfour)** –Ω–∞ —è–∑—ã–∫–µ C. –®–∏—Ñ—Ä –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏: –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –±–∞–π—Ç –∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞.

---

## üîê –¢–µ–æ—Ä–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RC4

RC4 ‚Äî —ç—Ç–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –†–æ–Ω–æ–º –†–∏–≤–µ—Å—Ç–æ–º –≤ 1987 –≥–æ–¥—É. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–∞:

### 1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (KSA ‚Äì Key Scheduling Algorithm)**

- –°–æ–∑–¥–∞—ë—Ç—Å—è –º–∞—Å—Å–∏–≤ `S` —Ä–∞–∑–º–µ—Ä–æ–º 256 –±–∞–π—Ç.
- –ú–∞—Å—Å–∏–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç 0 –¥–æ 255.
- –ó–∞—Ç–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Å—Å–∏–≤–∞ `S` –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–ª—é—á–∞.

### 2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (PRGA ‚Äì Pseudo-Random Generation Algorithm)**

- –ò–∑ –º–∞—Å—Å–∏–≤–∞ `S` –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã–µ –±–∞–π—Ç—ã.
- –ö–∞–∂–¥—ã–π –±–∞–π—Ç –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏–ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏) —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –æ–ø–µ—Ä–∞—Ü–∏–∏ XOR.

> üîÅ RC4 —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

---

## ‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

### `Arcfour *rc4init(int8* key, int16 size)`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É RC4:
- –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
- –ó–∞–ø–æ–ª–Ω—è–µ—Ç –º–∞—Å—Å–∏–≤ `s[256]` –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç 0 –¥–æ 255.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç Key Scheduling Algorithm (–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∞—Å—Å–∏–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–∞).
- –í—ã–ø–æ–ª–Ω—è–µ—Ç "whitewash" ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –±–∞–π—Ç –ø–æ—Ç–æ–∫–∞ (–¥–ª—è –ª—É—á—à–µ–π —ç–Ω—Ç—Ä–æ–ø–∏–∏).

---

### `int8 rc4byte(Arcfour* p)`

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –±–∞–π—Ç –∏–∑ –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞:
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å—ã `i` –∏ `j`.
- –ú–µ–Ω—è–µ—Ç –º–µ—Å—Ç–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `s[i]` –∏ `s[j]`.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `s[(s[i] + s[j]) % 256]`.

---

### `int8 *rc4encrypt(Arcfour* p, int8* cleartext, int16 size)`

–®–∏—Ñ—Ä—É–µ—Ç (–∏–ª–∏ –¥–µ—à–∏—Ñ—Ä—É–µ—Ç) –º–∞—Å—Å–∏–≤ –±–∞–π—Ç:
- –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –ø–æ–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
- –ü–æ–±–∞–π—Ç–æ–≤–æ XOR-–∏—Ç –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç —Å –±–∞–π—Ç–∞–º–∏ –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∏ –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏, —Ç–∞–∫ –∫–∞–∫ RC4 ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π —à–∏—Ñ—Ä.

---

### `void rc4uninit(Arcfour* p)`

- –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É RC4.

---

### `void printbin(const int8 *input, const int16 size)`

- –í—ã–≤–æ–¥–∏—Ç –º–∞—Å—Å–∏–≤ –±–∞–π—Ç –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º –≤–∏–¥–µ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ 2 –±–∞–π—Ç–∞.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ arcfour.c    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ RC4
‚îÇ   ‚îú‚îÄ‚îÄ arcfour.h    # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª —Å –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ —Ñ—É–Ω–∫—Ü–∏–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä
‚îÇ   ‚îî‚îÄ‚îÄ example.c    # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RC4 (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞)
‚îú‚îÄ‚îÄ Makefile         # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞
‚îî‚îÄ‚îÄ README.md        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è 

